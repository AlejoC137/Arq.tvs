import{j as e}from"./vendor-ui-BuaZYnYi.js";import{a as n}from"./vendor-react-C8ngQyMK.js";import{u as M,R as f,f as Z,g as I,C as J,T as N,B as T,h as k,X as D,Y as B,L as F,i as L}from"./vendor-charts-CQgSfZ3A.js";import{b as A,F as Q,H as U,g as j}from"./index-BMF47wD1.js";import{C as V,a as W,B as ee}from"./clock-LhWiBWuD.js";import"./vendor-pdf-Dysq3M1X.js";/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=A("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=A("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),ne=()=>{const m=M(),[b,v]=n.useState(!0),[i,R]=n.useState([]),[w,O]=n.useState([]),[S,K]=n.useState([]),[y,_]=n.useState([]),[P,$]=n.useState([]);n.useEffect(()=>{(async()=>{v(!0);try{const[a,o,x,h,g]=await Promise.all([m(j("Tareas")),m(j("Proyectos")),m(j("Staff")),m(j("Stage")),m(j("Entregables_template"))]);a!=null&&a.payload&&R(a.payload),o!=null&&o.payload&&O(o.payload),x!=null&&x.payload&&K(x.payload),h!=null&&h.payload&&_(h.payload),g!=null&&g.payload&&$(g.payload)}catch(a){console.error("Error al cargar los datos del dashboard:",a)}finally{v(!1)}})()},[m]);const d=n.useMemo(()=>{if(b||i.length===0)return{total:0,estadoStats:{},proyectoStats:{},responsableStats:{},stageStats:{},completadas:0,enProceso:0,pendientes:0,proyectosActivos:0,totalStages:0,totalEntregables:0};const s=i.reduce((t,l)=>{const r=l.status||"Sin Estado";return t[r]=(t[r]||0)+1,t},{}),a=i.reduce((t,l)=>{const r=l.project_id||"Sin Proyecto";return t[r]||(t[r]=[]),t[r].push(l),t},{}),o=Object.keys(a).reduce((t,l)=>{var E;const r=a[l],c=r.reduce((u,G)=>u+(Number(G.progress_real)||0),0),p=r.length>0?c/r.length:0,q=((E=w.find(u=>u.id===l))==null?void 0:E.name)||"Sin Proyecto";return t[q]={progress:p,taskCount:r.length},t},{}),x=i.reduce((t,l)=>{const r=S.find(p=>p.id===l.staff_id),c=r?`${r.name} ${r.lastname||""}`.trim():"Sin Asignar";return t[c]=(t[c]||0)+1,t},{}),h=i.reduce((t,l)=>{const r=y.find(p=>p.id===l.stage_id),c=r?r.name:"Sin Etapa";return t[c]=(t[c]||0)+1,t},{}),g=new Set(i.map(t=>t.project_id));return{total:i.length,estadoStats:s,proyectoStats:o,responsableStats:x,stageStats:h,completadas:s.Completado||0,enProceso:s["En Progreso"]||0,pendientes:s.Pendiente||0,proyectosActivos:g.size,totalStages:y.length,totalEntregables:P.length}},[b,i,w,S,y,P]);if(b)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-xl font-semibold text-gray-700",children:"Cargando Dashboard... ðŸ—ï¸"})});const C=Object.entries(d.estadoStats).map(([s,a])=>({name:s,value:a})),z=Object.entries(d.responsableStats).sort(([,s],[,a])=>a-s).slice(0,10).map(([s,a])=>({name:s,tareas:a})),H=Object.entries(d.stageStats).sort(([,s],[,a])=>a-s).map(([s,a])=>({name:s,tareas:a})),X={Pendiente:"#FEB70F","En Progreso":"#3B82F6",Completado:"#10B981",Cancelado:"#EF4444"},Y=s=>X[s]||"#A1A1AA";return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Dashboard de Proyectos ðŸš€"}),e.jsx("p",{className:"text-gray-600",children:"Resumen ejecutivo del estado actual de las tareas y proyectos."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(ae,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Tareas"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.total})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(V,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completadas"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.completadas})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx(W,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En Progreso"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.enProceso})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(ee,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Proyectos Activos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.proyectosActivos})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:e.jsx(se,{className:"w-6 h-6 text-indigo-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Etapas Definidas"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.totalStages})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-pink-100 rounded-lg",children:e.jsx(Q,{className:"w-6 h-6 text-pink-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tipos Entregables"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.totalEntregables})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8 mb-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Estado de Tareas"}),e.jsx(f,{width:"100%",height:300,children:e.jsxs(Z,{children:[e.jsx(I,{data:C,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:({name:s,percent:a})=>`${s} (${(a*100).toFixed(0)}%)`,children:C.map(s=>e.jsx(J,{fill:Y(s.name)},`cell-${s.name}`))}),e.jsx(N,{})]})})]}),e.jsxs("div",{className:"lg:col-span-3 bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Carga de Trabajo (Top 10 Responsables)"}),e.jsx(f,{width:"100%",height:300,children:e.jsxs(T,{data:z,margin:{top:5,right:20,left:10,bottom:5},children:[e.jsx(k,{strokeDasharray:"3 3"}),e.jsx(D,{dataKey:"name",angle:-20,textAnchor:"end",height:60,interval:0}),e.jsx(B,{allowDecimals:!1}),e.jsx(N,{}),e.jsx(F,{}),e.jsx(L,{dataKey:"tareas",name:"Tareas Asignadas",fill:"#3B82F6"})]})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"DistribuciÃ³n de Tareas por Etapa"}),e.jsx(f,{width:"100%",height:300,children:e.jsxs(T,{data:H,margin:{top:5,right:20,left:10,bottom:5},children:[e.jsx(k,{strokeDasharray:"3 3"}),e.jsx(D,{dataKey:"name",interval:0}),e.jsx(B,{allowDecimals:!1}),e.jsx(N,{}),e.jsx(F,{}),e.jsx(L,{dataKey:"tareas",name:"NÂº de Tareas",fill:"#10B981"})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Progreso Real por Proyecto"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(d.proyectoStats).map(([s,a])=>{const o=a.progress.toFixed(1);return e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),s]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[a.taskCount," tareas"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"Progreso Real Promedio"}),e.jsxs("span",{children:[o,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${o}%`}})})]})]},s)})})]})})]})};export{ne as default};
